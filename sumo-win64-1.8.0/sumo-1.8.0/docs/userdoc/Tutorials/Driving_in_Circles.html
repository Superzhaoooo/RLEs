<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <meta property="og:image" content="../images/image-facebook.jpg">
        <meta property="og:image:type" content="image/jpeg">
        <meta property="og:image:width" content="1080">
        <meta property="og:image:height" content="1080">

        
        
        <link rel="canonical" href="https://sumo.dlr.de/docs/Tutorials/Driving_in_Circles.html">
        <link rel="shortcut icon" href="../favicon.ico">
        
        <title>Tutorials/Driving in Circles - SUMO Documentation</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="apple-touch-icon" href="../images/apple-touch-icon.png">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="../js/jquery-1.10.2.min.js" defer></script>
        <script src="../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 

      <script>
        // DARK MODE
        function detectColorScheme(){
          var theme="light";

          if(localStorage.getItem("sumo-docs-theme")){
              if(localStorage.getItem("sumo-docs-theme") == "dark"){
                  var theme = "dark";
              }
          } else if(!window.matchMedia) {
              return false;
          } else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
              var theme = "dark";
          }

          if (theme=="dark") {
              document.documentElement.setAttribute("data-theme", "dark");
          }
        }
        detectColorScheme();
      </script>

    </head>

    <body>

        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary text-center">
            <div class="container-fluid">
                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                </div>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../index.html" class="nav-link">Documentation</a>
                            </li>
                            <li class="navitem">
                                <a href="../Tutorials.html" class="nav-link">Tutorials</a>
                            </li>
                            <li class="navitem">
                                <a href="../FAQ.html" class="nav-link">FAQ</a>
                            </li>
                            <li class="navitem">
                                <a href="../Downloads.html" class="nav-link">Downloads</a>
                            </li>
                            <li class="navitem">
                                <a href="../Publications.html" class="nav-link">Publications</a>
                            </li>
                            <li class="navitem">
                                <a href="../Developer/Main.html" class="nav-link">Developer</a>
                            </li>
                            <li class="navitem">
                                <a href="../ChangeLog.html" class="nav-link">ChangeLog</a>
                            </li>
                            <li class="navitem">
                                <a href="https://github.com/eclipse/sumo/commits/master/docs/web" class="nav-link">Recent Changes</a>
                            </li>
                            <li class="navitem">
                                <a href="https://eclipse.org/sumo/contact/" class="nav-link">Contact</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> <u>S</u>earch
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="edit" href="https://github.com/eclipse/sumo/edit/master/docs/web/docs/Tutorials/Driving_in_Circles.md" class="nav-link"><i class="fa fa-github"></i> <u>E</u>dit on GitHub</a>
                            </li>
                      <li class="nav-item dropdown">
                          <a class="nav-link dropdown-toggle" href="#" id="navbardrop" data-toggle="dropdown">
                            More <i class="fa fa-chevron-circle-down"></i>
                          </a>
                          <div class="dropdown-menu dropdown-menu-right">
                            <a class="dropdown-item no-arrow-link" href="https://github.com/eclipse/sumo/issues">Report a Bug / Issue / Typo</a>
                            <a class="dropdown-item" href="../Editing_Articles.html">Help on editing articles</a>
                            <a class="dropdown-item" href="#" data-toggle="modal" data-target="#mkdocs_keyboard_modal">Keyboard Shortcuts</a>
                            <a class="dropdown-item no-arrow-link" href="https://sumo.dlr.de/sumo_documentation.zip">Download the Documentation</a>
                            <span class="dropdown-item" id="dark-mode-div">Dark mode <label id="theme-switch" class="theme-switch" for="checkbox_theme">
                              <input type="checkbox" id="checkbox_theme">
                          </label></span>
                          </div>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container-fluid">
          <div class="row">
                <div class="col-md-3">
                  <div class="text-center"><a href="../index.html" style="display: inline-block; margin-top: 5px;"><img src="../images/sumo-logo.png" class="sumoLogo" alt="SUMO Logo" width="120px"></a></div>
                  
<div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary toc-scroll toc">
        <ul class="nav flex-column bs-sidenav">
            <p style="margin-top:5px; color:#777777;" class="text-center">Contents</p>
            <li class="nav-item main"><a href="#build_a_network">Build a network</a></li>
            <li class="nav-item main"><a href="#create_vehicles_and_run_sumo">Create vehicles and run SUMO</a></li>
            <li class="nav-item main"><a href="#circular_rerouting">Circular rerouting</a></li>
            <li class="nav-item main"><a href="#exercises">Exercises</a></li>
        </ul>
    </div>

    <div class="admonition conference" style="position: sticky; margin-top: 20px; margin-bottom:10px;">
        <p>visit <a href="https://eclipse.org/sumo">eclipse.org/sumo</a></p>
        </div>

</div>
                  
                </div>
                <div class="col-md-9 main-area" role="main">
                  
                  <hTitles>Tutorials/Driving in Circles<hr style="border: 0.5px solid #338033; margin-top: 5px !important;"></hTitles>
                  
                  

<p>In this tutorial we will build a simple circular net with netedit and
use <a href="../Simulation/Rerouter.html">rerouters</a> to make vehicles drive
in circles. All definition files can also be found in the
<strong><em>&lt;SUMO_HOME&gt;</em></strong>/docs/tutorial/circles directory.</p>
<h1 id="build_a_network">Build a network<a class="headerlink" href="#build_a_network" title="Permanent link">#</a></h1>
<p>First open <a href="../netedit.html">netedit</a> and create edges to form a
closed loop. To do that press <code>Ctrl-N</code> to create a new network and then
press <code>e</code> to enter the edge editing mode. Now create a closed loop of
edges (you might consider to check 'chain' just right from the edit-mode
selection, see figure).</p>
<p><img alt="CircleNet.PNG" src="../images/CircleNet.PNG" title="CircleNet.PNG" /></p>
<p>The result should look more or less like shown in the figure. The
important thing is the circular shape. Now save the network somewhere
(<code>Ctrl-Shift-S</code>) in an empty directory (we will refer to that place by
<code>baseDir</code>). As name for the created net-file type in <code>circles.net.xml</code>.</p>
<h1 id="create_vehicles_and_run_sumo">Create vehicles and run SUMO<a class="headerlink" href="#create_vehicles_and_run_sumo" title="Permanent link">#</a></h1>
<p>In the <code>baseDir</code> create two empty text-files, call them
<code>circles.rou.xml</code> and <code>circles.sumocfg</code>. These files will define our
vehicles and the run configuration.</p>
<p>First, we edit <code>circles.rou.xml</code> and define a vehicle flow of five
standard passenger cars. The file contents should look like this:</p>
<pre><code>&lt;routes&gt;
   &lt;vType id=&quot;car&quot; type=&quot;passenger&quot; length=&quot;5&quot; accel=&quot;3.5&quot; decel=&quot;2.2&quot; sigma=&quot;1.0&quot;/&gt;
   &lt;flow id=&quot;carflow&quot; type=&quot;car&quot; beg=&quot;0&quot; end=&quot;0&quot; number=&quot;5&quot;/&gt;
&lt;/routes&gt;
</code></pre>

<p>For further explanation of how to define flows and vTypes see the
respective Wiki-pages: <a href="../Demand/Shortest_or_Optimal_Path_Routing.html#flow_definitions">Flow
Definitions</a>
and <a href="../Definition_of_Vehicles,_Vehicle_Types,_and_Routes.html#vehicle_types">Vehicle
Types</a>.</p>
<p>To use the route-file and the generated net-file with SUMO, we edit the
configuration-file <code>circles.sumocfg</code> to tell SUMO where it finds vehicle
and net definitions:</p>
<pre><code>&lt;configuration&gt;
    &lt;input&gt;
       &lt;net-file value=&quot;circles.net.xml&quot;/&gt;
       &lt;route-files value=&quot;circles.rou.xml&quot;/&gt;
    &lt;/input&gt;
&lt;/configuration&gt;
</code></pre>

<p><img alt="StartAttempt1.PNG" src="../images/StartAttempt1.PNG" title="First attempt to run the simulation" /></p>
<p>First attempt to run the simulation</p>
<p>Now let us try to start sumo with the config that we have just created.
To do so either double-click on the configuration-file <code>circles.sumocfg</code>
(under Windows, if your installation was done with default settings) or
change to the <code>baseDir</code> in a terminal and start sumo (with graphical
user interface) there by typing <code>sumo -c circles.sumocfg</code>. (If this does
not start sumo, you might have to add the SUMO/bin directory to your
PATH?)</p>
<p>Did it work? No.</p>
<p>Let us have a look at the Message Window at the bottom of the GUI to
endeavor what went wrong (by the way: the Message Window is often a very
useful resource for information for setting up a simulation take a look
at it first, if you run into problems).</p>
<p>It says: <code>Error: The route for flow 'carflow' has no edges.</code> This means
that SUMO does not know from where to where the vehicles of the flow we
declared in <code>circles.rou.xml</code> should take. To do this, we need to add
attributes <code>to</code> and <code>from</code>, and provide corresponding edge-ids to the
flow.</p>
<p><img alt="nameEdges.PNG" src="../images/NameEdges.PNG" title="Renaming an edge in netedit" /></p>
<p>Renaming an edge in netedit</p>
<p>The edge-ids can be inspected and modified in netedit: open your
network-file <code>circles.net.xml</code> and press <code>i</code> to enter the inspect-mode.
Left-click on an arbitrary edge and rename it to <code>edge1</code>. Left-click on
a different edge and rename it to <code>edge2</code>. Then save your network
(<code>Ctrl-S</code>).</p>
<p>Now we add the from-edge and the to-edge to the flow in
<code>circles.rou.xml</code>:</p>
<pre><code> ...
    &lt;flow id=&quot;carflow&quot; type=&quot;car&quot; beg=&quot;0&quot; end=&quot;0&quot; number=&quot;5&quot; from=&quot;edge1&quot; to=&quot;edge2&quot;/&gt;
 ...
</code></pre>

<p><img alt="running1.PNG" src="../images/Running1.PNG" title="Running five cars on the circular net" /></p>
<p>Running five cars on the circular net</p>
<p>Let's try to run SUMO again. The window should now show the network you
have created before in netedit and you can start the simulation by
clicking on the play button (<img alt="Image:play.gif" src="../images/Play.gif" title="Image:play.gif" />) or the step button (<img alt="Image:step.gif" src="../images/Step.gif" title="Image:step.gif" />). If you use <img alt="Image:play.gif" src="../images/Play.gif" title="Image:play.gif" />, be sure to adjust the value for the animation delay
time between consecutive simulation steps (the field labeled "Delay
(ms):", see figure). Otherwise SUMO will run the simulation as fast as
possible and you will probably see nothing happening at all. (Note that
the the figure uses the style "real world" from the
representation-dropdown-menu in the toolbar.)</p>
<p>The cars will drive from the beginning of edge1 to the end of edge2 and
then leave the net (side remark: you can control the positions of
departure and arrival by additional arguments to the flow, see <a href="../Demand/Shortest_or_Optimal_Path_Routing.html#flow_definitions">Flow
Definitions</a>).
The simulation ends when all vehicles have left the net.</p>
<h1 id="circular_rerouting">Circular rerouting<a class="headerlink" href="#circular_rerouting" title="Permanent link">#</a></h1>
<p>Now let us make the vehicles drive in circles around the track again and
again. To this end we will create a rerouter</p>
<p><img alt="" src="../images/SelectRerouter1.PNG" title="Create a rerouter in netedit (full implementation pending!)" /></p>
<p>Create a rerouter in netedit (full implementation pending!)</p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>Editing rerouters in netedit is not implemented completely currently. Alter the tutorial correspondingly, when this has been done! (See <a href="../netedit.html#rerouter">netedit#Rerouter</a>)</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the future the editing of rerouters will be possible in netedit. Up to now rerouters have to be added manually (see below). Here is what can be done in netedit so far: Open your network <code>circles.net</code> and press <code>a</code> to enter the additionals edit-mode. From the dropdown menu "Additional element" on the left select <code>rerouter</code> and from "Edges" select <code>edge1</code> (see figure). Then click somewhere in the editing window to create the rerouter (the rerouter icon is placed at the location where you click, but the location has no further meaning). Repeat the steps to create a rerouter for <code>edge2</code>.</p>
</div>
<p>Since in SUMO the additional elements are not considered as elements of
the net, we have to specify them in a separate file (the
"additionals-file"). Create and open a file <code>circles.add.xml</code> in the
<code>baseDir</code> and add the following xml-code (see <a href="../Simulation/Rerouter.html#assigning_a_new_destination">Rerouter/Assigning a new
Destination</a>
for details):</p>
<pre><code>&lt;additionals&gt;
    &lt;rerouter id=&quot;rerouter_0&quot; edges=&quot;edge1&quot;&gt;
        &lt;interval end=&quot;1e9&quot;&gt;
           &lt;destProbReroute id=&quot;edge2&quot;/&gt;
        &lt;/interval&gt;
    &lt;/rerouter&gt;
    &lt;rerouter id=&quot;rerouter_1&quot; edges=&quot;edge2&quot;&gt;
        &lt;interval end=&quot;1e9&quot;&gt;
           &lt;destProbReroute id=&quot;edge1&quot;/&gt;
        &lt;/interval&gt;
    &lt;/rerouter&gt;
&lt;/additionals&gt;
</code></pre>

<p>Then we have to tell SUMO to include the rerouters into the simulation
by adding a line to the config <code>circles.sumocfg</code>. Within the <code>&lt;input&gt;</code> tag
add a child:</p>
<pre><code>&lt;additional-files value=&quot;circles.add.xml&quot;/&gt;
</code></pre>

<p>This will add two (destination-)rerouters to our network making the
vehicles go around the circle until the given end time (i.e., until one
hundred million seconds have passed). Effectively, each rerouter will
update the destination for each vehicle entering its edge (specified by
its <code>edge</code>-attribute) and set it to the edge given in the <code>id</code>-attribute
of the <code>destProbReroute</code>-element. So as soon as a vehicle enters <code>edge1</code>
(its current destination), its destination will be updated to <code>edge2</code>
and vice-versa, when entering <code>edge2</code> it will be rerouted towards
<code>edge1</code>, thus following a circular route.</p>
<h1 id="exercises">Exercises<a class="headerlink" href="#exercises" title="Permanent link">#</a></h1>
<p>Here are some simple ideas to extend this toy example:
<img alt="twoloops.png" src="../images/Twoloops.png" title="twoloops.png" /></p>
<p>A net with two loops</p>
<ol>
<li>add more lanes in netedit and another vehicle flow with faster cars
    to observe SUMO's overtaking behavior.</li>
<li>add a scooter flow and use the <a href="../Simulation/SublaneModel.html">Sublane
    Model</a> to observe SUMO's sublane
    model.</li>
<li>add another loop (see figure) and trigger the next loop for each
    vehicle by a probabilistic choice of the destination
    (<a href="../Simulation/Rerouter.html#assigning_a_new_destination">Rerouter/Assigning a new
    Destination</a>),
    observe merging at the location where both loops are connected.</li>
<li>Insert more vehicles, lower the simulation <a href="../Simulation/Basic_Definition.html#defining_the_time_step_length_and_integration_method">time-step
    length</a>
    and try to observe stop-and-go waves, experiment with different
    <a href="../Car-Following-Models.html">car-following models</a>, <a href="../sumo-gui.html#vehicle_visualisation_settings">color the
    vehicles</a> by
    speed.</li>
</ol>
<p>If you create solutions for the exercises post them on this page!</p>
<p>Back to <a href="../Tutorials.html">Tutorials</a></p>
                </div>
          </div>
          <button onclick="goTopFunction()" id="goToTop" title="Go to top"><i class="fa fa-arrow-up"></i></button>
        </div>

        <footer class="col-md-12">
          
            <br><small><i>This page was last edited on: 08 July 2020</i></small>
          
          <hr>
            <p>Copyright &copy; 2001 - 2020 German Aerospace Center (DLR) and others.</p>
          <p>Follow us on <a class="no-arrow-link" href="https://www.twitter.com/eclipsesumo/"><i class="fa fa-twitter"></i></a> <a class="no-arrow-link" href="https://www.facebook.com/simulationofurbanmobility/"><i class="fa fa-facebook-square"></i></a> <a class="no-arrow-link" href="https://www.instagram.com/eclipse.sumo/"><i class="fa fa-instagram"></i></a>
          | Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a></p>
        </footer>

      <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body" style="color: #495057 !important;">
                <p>Enter your search terms:</p>
                <script async src="https://cse.google.com/cse.js?cx=004302551366764109984:1kpgtzrm6kv"></script>
                <div class="gcse-search"></div>
            </div>
            <div class="modal-footer" style="color: #495057 !important;">
                or search the sumo-user mailing list archive&nbsp;<a class="no-arrow-link" href="http://sumo-user.90755.n8.nabble.com/template/NamlServlet.jtp?macro=search_page&node=1&query=">here</a>
            </div>
        </div>
    </div>
</div>
      <script>
        window.onscroll = function() {scrollFunction()};
        
        function scrollFunction() {
          if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
            document.getElementById("goToTop").style.display = "block";
          } else {
            document.getElementById("goToTop").style.display = "none";
          }
        }
    
        function goTopFunction() {
          document.body.scrollTop = 0;
          document.documentElement.scrollTop = 0;
        }

        var base_url = "..",
            shortcuts = {"help": 191, "search": 83, "edit": 69};
        </script>
        <script src="../js/base.js" defer></script>

        <script>
          const toggleSwitch = document.querySelector('#theme-switch input[type="checkbox"]');
  
          function switchTheme(e) {
              if (e.target.checked) {
                  localStorage.setItem('sumo-docs-theme', 'dark');
                  document.documentElement.setAttribute('data-theme', 'dark');
                  toggleSwitch.checked = true;
              } else {
                  localStorage.setItem('sumo-docs-theme', 'light');
                  document.documentElement.setAttribute('data-theme', 'light');
                  toggleSwitch.checked = false;
              }    
          }
  
          toggleSwitch.addEventListener('change', switchTheme, false);
  
          if (document.documentElement.getAttribute("data-theme") == "dark"){
              toggleSwitch.checked = true;
          }
          </script>

      <div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Key</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody style="color: #495057 !important;">
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help dialog</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search the Documentation</td>
                  </tr>
                  <tr>
                    <td class="edit shortcut"><kbd>e</kbd></td>
                    <td>Edit current page on GitHub</td>
                  </tr>
                </tbody>
              </table>
            </div>
        </div>
    </div>
</div>
    </body>
</html>
